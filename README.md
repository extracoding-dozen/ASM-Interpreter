# Central Processor Emulator (CP-Emulator)

**CP-Emulator** ‚Äî —ç—Ç–æ –ø—Ä–æ–µ–∫—Ç –Ω–∞ C++, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π —ç–º—É–ª—è—Ç–æ—Ä —É–ø—Ä–æ—â–µ–Ω–Ω–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ—Ç –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–¥ –Ω–∞ –∞—Å—Å–µ–º–±–ª–µ—Ä–æ-–ø–æ–¥–æ–±–Ω–æ–º —è–∑—ã–∫–µ, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞–º–∏ –æ–±—â–µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è, —Ñ–ª–∞–≥–∞–º–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç—å—é –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –≤–∞–ª–∏–¥–∞—Ç–æ—Ä –∫–æ–¥–∞ (—Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑), —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø–∞–º—è—Ç–∏ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∫–æ–º–∞–Ω–¥.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

*   **–≠–º—É–ª—è—Ü–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤:**
    *   –û–±—â–µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è: `AX`, `BX`, `CX`, `DX`, `SI`, `DI`, `BP`, `SP`.
    *   –§–ª–∞–≥–æ–≤—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã: `CF`, `PF`, `AF`, `ZF`, `SF`, `TF`, `IF`, `DF`, `OF`.
*   **–¢–∏–ø–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞–∫ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã—Ö (`int64_t`), —Ç–∞–∫ –∏ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö (`double`) —á–∏—Å–µ–ª (—á–µ—Ä–µ–∑ `std::any`).
*   **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–µ–∫—Ü–∏–∏ `.data` –¥–ª—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.
*   **–†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã:**
    *   –ü–æ–ª–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã.
    *   –ü–æ—à–∞–≥–æ–≤–∞—è –æ—Ç–ª–∞–¥–∫–∞ (`step by step`).
*   **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ `.s` —Å –ø–æ–º–æ—â—å—é —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º.
*   **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–∞–º—è—Ç–∏:** –°–±–æ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **AddressSanitizer** –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —É—Ç–µ—á–µ–∫ –∏ –æ—à–∏–±–æ–∫ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–º—è—Ç–∏.

## üõ† –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∫–æ–º–∞–Ω–¥—ã

–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±–∞–∑–æ–≤—ã–π –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π:

*   `MOV dest, src` ‚Äî –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (–º–µ–∂–¥—É —Ä–µ–≥–∏—Å—Ç—Ä–∞–º–∏, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∏–ª–∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞–º–∏).
*   `ADD dest, src` ‚Äî –°–ª–æ–∂–µ–Ω–∏–µ.
*   `MULT dest, src` ‚Äî –£–º–Ω–æ–∂–µ–Ω–∏–µ (—Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –≤ —Ñ–ª–∞–≥ `OF`).

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

*   **–û–°:** Linux / macOS.
*   **–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä:** `g++` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π **C++17** (—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è `std::any` –∏ `std::filesystem`).
*   **–°–±–æ—Ä–∫–∞:** —É—Ç–∏–ª–∏—Ç–∞ `make`.

## üî® –°–±–æ—Ä–∫–∞ –∏ –ó–∞–ø—É—Å–∫

–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `Makefile` —Å –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ —Ñ–ª–∞–≥–∞–º–∏ –æ—Ç–ª–∞–¥–∫–∏ –∏ —Å–∞–Ω–∏—Ç–∞–π–∑–µ—Ä–∞–º–∏.

### 1. –°–±–æ—Ä–∫–∞ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞
–î–ª—è —Å–±–æ—Ä–∫–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
make build_asan
```
    
–ë—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª `bin_asan`.

### 2. –°–±–æ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

–ï—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –∫–∞–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫—É (**libCentralProcessor.a**):

```bash
make build_asan_W
```

  

### 3. –ó–∞–ø—É—Å–∫

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –æ–∂–∏–¥–∞–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–∞ —Å –∫–æ–¥–æ–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é input.s).
code Bash
```
./bin_asan
```
  

#### üìù –§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (input.s)

–≠–º—É–ª—è—Ç–æ—Ä –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ñ–∞–π–ª—ã —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º .s. –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã:
code Asm
```
section .data
    val1  db 10
    val2  db 5.5
    res   db 0

section .text
_start:
    mov ax, val1      ; –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –≤ —Ä–µ–≥–∏—Å—Ç—Ä
    add ax, 20        ; –°–ª–æ–∂–µ–Ω–∏–µ —Å –∫–æ–Ω—Å—Ç–∞–Ω—Ç–æ–π
    mult ax, val2     ; –£–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ –¥—Ä–æ–±–Ω–æ–µ —á–∏—Å–ª–æ
    mov res, ax       ; –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
```

#### üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
    Core/ ‚Äî –Ø–¥—Ä–æ —ç–º—É–ª—è—Ç–æ—Ä–∞.
        RegisterBlock ‚Äî –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞–º–∏ –∏ —Ñ–ª–∞–≥–∞–º–∏.
        VariableMemory ‚Äî –•—Ä–∞–Ω–∏–ª–∏—â–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.
        Programm ‚Äî –õ–æ–≥–∏–∫–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–æ–º–∞–Ω–¥.
        Command ‚Äî –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞ Command (Add, Mult, Mov).
    Validator/ ‚Äî –ö–ª–∞—Å—Å –¥–ª—è –ª–µ–∫—Å–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ñ–∞–π–ª–∞.
    DynMemory/ ‚Äî –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è —à–∞–±–ª–æ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ (–∞–Ω–∞–ª–æ–≥ std::vector).

    main.cpp ‚Äî –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞.

## ‚ö†Ô∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –ø–æ –æ—Ç–ª–∞–¥–∫–µ

–ü—Ä–æ–µ–∫—Ç —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è —Å —Ñ–ª–∞–≥–∞–º–∏ -`fsanitize=address -g -O0.` –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –±—É–¥–µ—Ç –ø–æ—Ç—Ä–µ–±–ª—è—Ç—å –±–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏, –Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—è–≤–∏—Ç –æ—à–∏–±–∫–∏ —Ä–∞–±–æ—Ç—ã —Å –ø–∞–º—è—Ç—å—é (buffer overflow, use-after-free) –∏ –≤—ã–≤–µ–¥–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á–µ—Ç –≤ –∫–æ–Ω—Å–æ–ª—å –ø—Ä–∏ –∏—Ö –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏.